{
  "desc": "element enumeration",
  "testType": "enumerate",
  "schemas": {
    "string": { "kind": "primitive-type" },
    "boolean": { "kind": "primitive-type" },
    "integer": { "kind": "primitive-type" },
    "code": { "kind": "primitive-type" },
    "HumanName": {
      "elements": {
        "family": { "type": "string" },
        "given": { "type": "string", "array": true }
      }
    },
    "Resource": {
      "elements": {
        "resourceType": { "type": "string" },
        "id": { "type": "string" }
      }
    },
    "DomainResource": {
      "base": "Resource",
      "elements": {
        "narrative": { "type": "string" }
      }
    },
    "Patient": {
      "base": "DomainResource",
      "elements": {
        "active": { "type": "boolean" },
        "name": { "type": "HumanName", "array": true },
        "gender": {
          "type": "code",
          "binding": {
            "valueSet": "http://hl7.org/fhir/ValueSet/administrative-gender",
            "strength": "required"
          }
        },
        "multipleBirth": {
          "choices": ["multipleBirthBoolean", "multipleBirthInteger"]
        },
        "multipleBirthBoolean": {
          "choiceOf": "multipleBirth",
          "type": "boolean"
        },
        "multipleBirthInteger": {
          "choiceOf": "multipleBirth",
          "type": "integer"
        }
      }
    },
    "USCorePatient": {
      "base": "Patient",
      "required": ["name", "gender"],
      "elements": {
        "name": { "min": 1 },
        "gender": {
          "binding": {
            "valueSet": "http://hl7.org/fhir/us/core/ValueSet/birthsex",
            "strength": "extensible"
          }
        }
      }
    },
    "Extension": {
      "elements": {
        "url": { "type": "string" },
        "valueString": { "choiceOf": "value", "type": "string" }
      }
    },
    "PatientWithExtensions": {
      "base": "Patient",
      "extensions": {
        "us-core-race": {
          "url": "http://hl7.org/fhir/us/core/StructureDefinition/us-core-race",
          "min": 0,
          "max": 1
        }
      },
      "elements": {
        "extension": { "type": "Extension", "array": true }
      }
    }
  },
  "tests": [
    {
      "desc": "enumerate simple schema with own elements",
      "schemas": ["Patient"],
      "expected": {
        "resourceType": { "type": "string", "definedIn": ["Resource"] },
        "id": { "type": "string", "definedIn": ["Resource"] },
        "narrative": { "type": "string", "definedIn": ["DomainResource"] },
        "active": { "type": "boolean", "definedIn": ["Patient"] },
        "name": {
          "type": "HumanName",
          "array": true,
          "definedIn": ["Patient"],
          "elements": {
            "family": { "type": "string", "definedIn": ["HumanName"] },
            "given": {
              "type": "string",
              "array": true,
              "definedIn": ["HumanName"]
            }
          }
        },
        "gender": {
          "type": "code",
          "definedIn": ["Patient"],
          "binding": {
            "valueSet": "http://hl7.org/fhir/ValueSet/administrative-gender",
            "strength": "required"
          }
        },
        "multipleBirth": {
          "choices": ["multipleBirthBoolean", "multipleBirthInteger"],
          "definedIn": ["Patient"]
        },
        "multipleBirthBoolean": {
          "type": "boolean",
          "choiceOf": "multipleBirth",
          "definedIn": ["Patient"]
        },
        "multipleBirthInteger": {
          "type": "integer",
          "choiceOf": "multipleBirth",
          "definedIn": ["Patient"]
        }
      }
    },
    {
      "desc": "enumerate profile with inherited and overridden constraints",
      "schemas": ["USCorePatient"],
      "expected": {
        "resourceType": { "type": "string", "definedIn": ["Resource"] },
        "id": { "type": "string", "definedIn": ["Resource"] },
        "narrative": { "type": "string", "definedIn": ["DomainResource"] },
        "active": { "type": "boolean", "definedIn": ["Patient"] },
        "name": {
          "type": "HumanName",
          "array": true,
          "min": 1,
          "definedIn": ["Patient", "USCorePatient"],
          "elements": {
            "family": { "type": "string", "definedIn": ["HumanName"] },
            "given": {
              "type": "string",
              "array": true,
              "definedIn": ["HumanName"]
            }
          }
        },
        "gender": {
          "type": "code",
          "definedIn": ["Patient", "USCorePatient"],
          "binding": {
            "valueSet": "http://hl7.org/fhir/us/core/ValueSet/birthsex",
            "strength": "extensible"
          }
        },
        "multipleBirth": {
          "choices": ["multipleBirthBoolean", "multipleBirthInteger"],
          "definedIn": ["Patient"]
        },
        "multipleBirthBoolean": {
          "type": "boolean",
          "choiceOf": "multipleBirth",
          "definedIn": ["Patient"]
        },
        "multipleBirthInteger": {
          "type": "integer",
          "choiceOf": "multipleBirth",
          "definedIn": ["Patient"]
        }
      }
    },
    {
      "desc": "enumerate schema with extensions",
      "schemas": ["PatientWithExtensions"],
      "expectedPartial": {
        "extension": {
          "type": "Extension",
          "array": true,
          "definedIn": ["PatientWithExtensions"],
          "slicing": {
            "slices": {
              "us-core-race": {
                "url": "http://hl7.org/fhir/us/core/StructureDefinition/us-core-race",
                "min": 0,
                "max": 1
              }
            }
          }
        }
      }
    }
  ]
}
