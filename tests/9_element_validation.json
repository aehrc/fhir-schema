{
  "desc": "element value validation",
  "testType": "validateElement",
  "schemas": {
    "string": { "kind": "primitive-type" },
    "boolean": { "kind": "primitive-type" },
    "integer": { "kind": "primitive-type" },
    "code": { "kind": "primitive-type" },
    "HumanName": {
      "elements": {
        "family": { "type": "string" },
        "given": { "type": "string", "array": true }
      }
    },
    "Resource": {
      "elements": {
        "resourceType": { "type": "string" },
        "id": { "type": "string" }
      }
    },
    "Patient": {
      "base": "Resource",
      "elements": {
        "active": { "type": "boolean" },
        "name": {
          "type": "HumanName",
          "array": true,
          "max": 3
        },
        "gender": {
          "type": "code",
          "pattern": "male"
        },
        "identifier": {
          "type": "Identifier",
          "array": true,
          "required": ["system", "value"]
        }
      }
    },
    "Identifier": {
      "elements": {
        "system": { "type": "string" },
        "value": { "type": "string" }
      }
    },
    "USCorePatient": {
      "base": "Patient",
      "required": ["name"],
      "elements": {
        "name": { "min": 1 }
      }
    }
  },
  "tests": [
    {
      "desc": "valid simple string value",
      "schemas": ["Patient"],
      "path": ["id"],
      "value": "patient-123",
      "errors": []
    },
    {
      "desc": "valid boolean value",
      "schemas": ["Patient"],
      "path": ["active"],
      "value": true,
      "errors": []
    },
    {
      "desc": "valid nested path - family name",
      "schemas": ["Patient"],
      "path": ["name", "family"],
      "value": "Smith",
      "errors": []
    },
    {
      "desc": "valid array element",
      "schemas": ["Patient"],
      "path": ["name"],
      "value": [{ "family": "Smith" }],
      "errors": []
    },
    {
      "desc": "array cardinality exceeded",
      "schemas": ["Patient"],
      "path": ["name"],
      "value": [
        { "family": "Smith" },
        { "family": "Jones" },
        { "family": "Brown" },
        { "family": "Wilson" }
      ],
      "errors": [
        {
          "type": "max",
          "path": "name",
          "message": "expected 3 < 4"
        }
      ]
    },
    {
      "desc": "pattern constraint failure",
      "schemas": ["Patient"],
      "path": ["gender"],
      "value": "female",
      "errors": [
        {
          "type": "pattern-value",
          "path": "gender",
          "message": "Expected value to match 'pattern' 'male', but got: 'female'"
        }
      ]
    },
    {
      "desc": "required nested elements missing",
      "schemas": ["Patient"],
      "path": ["identifier"],
      "value": [{ "system": "http://example.org" }],
      "errors": [
        {
          "type": "required",
          "path": "identifier.0.value",
          "message": "value is required"
        }
      ]
    },
    {
      "desc": "unknown element path",
      "schemas": ["Patient"],
      "path": ["unknownElement"],
      "value": "anything",
      "errors": [
        {
          "type": "unknown-element",
          "path": "unknownElement",
          "message": "unknownElement is unknown"
        }
      ]
    },
    {
      "desc": "inherited element validation - id from Resource",
      "schemas": ["Patient"],
      "path": ["id"],
      "value": "valid-id",
      "errors": []
    },
    {
      "desc": "profile constraint - min cardinality from USCorePatient",
      "schemas": ["USCorePatient"],
      "path": ["name"],
      "value": [],
      "errors": [
        {
          "type": "min",
          "path": "name",
          "message": "expected 1 > 0"
        }
      ]
    },
    {
      "desc": "empty path validates root object",
      "schemas": ["Patient"],
      "path": [],
      "value": {
        "resourceType": "Patient",
        "id": "pt-1"
      },
      "errors": []
    }
  ]
}
